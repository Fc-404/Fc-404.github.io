import{bx as Y,e as j,_ as f,s as $,j as X,E as ee,x as T,Z as te,X as re,W as ne,i as se,n as ae,d as _,a0 as B,k as G,H as k,aZ as F,b as S,f as w,P as oe,A as ie,h as le}from"./index-d5885ca1.js";import{R as ce}from"./index-c9f151af.js";import{a as ue}from"./index-d3b7b29b.js";const de=["xxxl","xxl","xl","lg","md","sm","xs"],pe=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`,xxxl:`{min-width: ${e.screenXXXL}px}`});function ge(){const[,e]=Y();return j(()=>{const t=pe(e.value),r=new Map;let n=-1,l={};return{matchHandlers:{},dispatch(o){return l=o,r.forEach(i=>i(l)),r.size>=1},subscribe(o){return r.size||this.register(),n+=1,r.set(n,o),o(l),n},unsubscribe(o){r.delete(o),r.size||this.unregister()},unregister(){Object.keys(t).forEach(o=>{const i=t[o],s=this.matchHandlers[i];s==null||s.mql.removeListener(s==null?void 0:s.listener)}),r.clear()},register(){Object.keys(t).forEach(o=>{const i=t[o],s=p=>{let{matches:u}=p;this.dispatch(f(f({},l),{[o]:u}))},c=window.matchMedia(i);c.addListener(s),this.matchHandlers[i]={mql:c,listener:s},s(c)})},responsiveMap:t}})}function ve(){const e=$({});let t=null;const r=ge();return X(()=>{t=r.value.subscribe(n=>{e.value=n})}),ee(()=>{r.value.unsubscribe(t)}),e}function he(e){const t=$();return T(()=>{t.value=e()},{flush:"sync"}),t}const me=e=>{const{antCls:t,componentCls:r,iconCls:n,avatarBg:l,avatarColor:o,containerSize:i,containerSizeLG:s,containerSizeSM:c,textFontSize:p,textFontSizeLG:u,textFontSizeSM:M,borderRadius:z,borderRadiusLG:d,borderRadiusSM:C,lineWidth:h,lineType:x}=e,v=(m,a,g)=>({width:m,height:m,lineHeight:`${m-h*2}px`,borderRadius:"50%",[`&${r}-square`]:{borderRadius:g},[`${r}-string`]:{position:"absolute",left:{_skip_check_:!0,value:"50%"},transformOrigin:"0 center"},[`&${r}-icon`]:{fontSize:a,[`> ${n}`]:{margin:0}}});return{[r]:f(f(f(f({},ne(e)),{position:"relative",display:"inline-block",overflow:"hidden",color:o,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:l,border:`${h}px ${x} transparent`,"&-image":{background:"transparent"},[`${t}-image-img`]:{display:"block"}}),v(i,p,z)),{"&-lg":f({},v(s,u,d)),"&-sm":f({},v(c,M,C)),"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}})}},fe=e=>{const{componentCls:t,groupBorderColor:r,groupOverlapping:n,groupSpace:l}=e;return{[`${t}-group`]:{display:"inline-flex",[`${t}`]:{borderColor:r},"> *:not(:first-child)":{marginInlineStart:n}},[`${t}-group-popover`]:{[`${t} + ${t}`]:{marginInlineStart:l}}}},I=te("Avatar",e=>{const{colorTextLightSolid:t,colorTextPlaceholder:r}=e,n=re(e,{avatarBg:r,avatarColor:t});return[me(n),fe(n)]},e=>{const{controlHeight:t,controlHeightLG:r,controlHeightSM:n,fontSize:l,fontSizeLG:o,fontSizeXL:i,fontSizeHeading3:s,marginXS:c,marginXXS:p,colorBorderBg:u}=e;return{containerSize:t,containerSizeLG:r,containerSizeSM:n,textFontSize:Math.round((o+i)/2),textFontSizeLG:s,textFontSizeSM:l,groupSpace:p,groupOverlapping:-c,groupBorderColor:u}}),W=Symbol("AvatarContextKey"),Se=()=>se(W,{}),xe=e=>ae(W,e),ye=()=>({prefixCls:String,shape:{type:String,default:"circle"},size:{type:[Number,String,Object],default:()=>"default"},src:String,srcset:String,icon:oe.any,alt:String,gap:Number,draggable:{type:Boolean,default:void 0},crossOrigin:String,loadError:{type:Function}}),be=_({compatConfig:{MODE:3},name:"AAvatar",inheritAttrs:!1,props:ye(),slots:Object,setup(e,t){let{slots:r,attrs:n}=t;const l=$(!0),o=$(!1),i=$(1),s=$(null),c=$(null),{prefixCls:p}=B("avatar",e),[u,M]=I(p),z=Se(),d=j(()=>e.size==="default"?z.size:e.size),C=ve(),h=he(()=>{if(typeof e.size!="object")return;const a=de.find(b=>C.value[b]);return e.size[a]}),x=a=>h.value?{width:`${h.value}px`,height:`${h.value}px`,lineHeight:`${h.value}px`,fontSize:`${a?h.value/2:18}px`}:{},v=()=>{if(!s.value||!c.value)return;const a=s.value.offsetWidth,g=c.value.offsetWidth;if(a!==0&&g!==0){const{gap:b=4}=e;b*2<g&&(i.value=g-b*2<a?(g-b*2)/a:1)}},m=()=>{const{loadError:a}=e;(a==null?void 0:a())!==!1&&(l.value=!1)};return G(()=>e.src,()=>{k(()=>{l.value=!0,i.value=1})}),G(()=>e.gap,()=>{k(()=>{v()})}),X(()=>{k(()=>{v(),o.value=!0})}),()=>{var a,g;const{shape:b,src:P,alt:N,srcset:q,draggable:D,crossOrigin:K}=e,Q=(a=z.shape)!==null&&a!==void 0?a:b,A=F(r,e,"icon"),y=p.value,U={[`${n.class}`]:!!n.class,[y]:!0,[`${y}-lg`]:d.value==="large",[`${y}-sm`]:d.value==="small",[`${y}-${Q}`]:!0,[`${y}-image`]:P&&l.value,[`${y}-icon`]:A,[M.value]:!0},Z=typeof d.value=="number"?{width:`${d.value}px`,height:`${d.value}px`,lineHeight:`${d.value}px`,fontSize:A?`${d.value/2}px`:"18px"}:{},E=(g=r.default)===null||g===void 0?void 0:g.call(r);let O;if(P&&l.value)O=S("img",{draggable:D,src:P,srcset:q,onError:m,alt:N,crossorigin:K},null);else if(A)O=A;else if(o.value||i.value!==1){const R=`scale(${i.value}) translateX(-50%)`,V={msTransform:R,WebkitTransform:R,transform:R},J=typeof d.value=="number"?{lineHeight:`${d.value}px`}:{};O=S(ce,{onResize:v},{default:()=>[S("span",{class:`${y}-string`,ref:s,style:f(f({},J),V)},[E])]})}else O=S("span",{class:`${y}-string`,ref:s,style:{opacity:0}},[E]);return u(S("span",w(w({},n),{},{ref:c,class:U,style:[Z,x(!!A),n.style]}),[O]))}}}),L=be,$e=()=>({prefixCls:String,maxCount:Number,maxStyle:{type:Object,default:void 0},maxPopoverPlacement:{type:String,default:"top"},maxPopoverTrigger:String,size:{type:[Number,String,Object],default:"default"},shape:{type:String,default:"circle"}}),ze=_({compatConfig:{MODE:3},name:"AAvatarGroup",inheritAttrs:!1,props:$e(),setup(e,t){let{slots:r,attrs:n}=t;const{prefixCls:l,direction:o}=B("avatar",e),i=j(()=>`${l.value}-group`),[s,c]=I(l);return T(()=>{const p={size:e.size,shape:e.shape};xe(p)}),()=>{const{maxPopoverPlacement:p="top",maxCount:u,maxStyle:M,maxPopoverTrigger:z="hover",shape:d}=e,C={[i.value]:!0,[`${i.value}-rtl`]:o.value==="rtl",[`${n.class}`]:!!n.class,[c.value]:!0},h=F(r,e),x=ie(h).map((m,a)=>le(m,{key:`avatar-key-${a}`})),v=x.length;if(u&&u<v){const m=x.slice(0,u),a=x.slice(u,v);return m.push(S(ue,{key:"avatar-popover-key",content:a,trigger:z,placement:p,overlayClassName:`${i.value}-popover`},{default:()=>[S(L,{style:M,shape:d},{default:()=>[`+${v-u}`]})]})),s(S("div",w(w({},n),{},{class:C,style:n.style}),[m]))}return s(S("div",w(w({},n),{},{class:C,style:n.style}),[x]))}}}),H=ze;L.Group=H;L.install=function(e){return e.component(L.name,L),e.component(H.name,H),e};export{L as A,de as r,ge as u};
